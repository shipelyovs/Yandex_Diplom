#Задание 1
#Вывод списка логинов курьеров с количеством их заказов в статусе «В доставке» (поле inDelivery = true)

SELECT 
    couriers.login,
    COUNT(orders.id) AS delivery_orders_count
FROM 
    couriers
JOIN 
    orders ON couriers.id = orders.courierId
WHERE 
    orders.inDelivery = true
GROUP BY 
    couriers.login;

#Задание 2
#Вывод всех трекеров заказов и их статусов

SELECT 
    track,
    CASE
        WHEN finished = true THEN 2
        WHEN cancelled = true THEN -1
        WHEN inDelivery = true THEN 1
        ELSE 0
    END AS status
FROM 
    orders;
